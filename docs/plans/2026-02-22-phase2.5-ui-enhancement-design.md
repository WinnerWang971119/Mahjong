# Phase 2.5 — UI Enhancement & Bug Fix Design

**Date:** 2026-02-22
**Approach:** Bug-fix-first sequential (fix bugs → interaction feedback → visual polish)
**Scope:** Visual-only (no sound effects), polish existing design (no overhaul)

## 1. Bug Fixes

### 1a. Discard Flash Bug
- **Symptom:** When discarding a tile, a brief flash of end-game/scoring UI appears for ~0.1s then disappears
- **Likely cause:** State transition race — event handler sets screen to 'scoring' momentarily during normal play events, or stale state causes flicker
- **Fix:** Add guard so scoring screen only renders when `scoringResult` is populated AND event is truly win/draw. Ensure screen transitions are debounced or gated behind animation completion

### 1b. Animations Not Playing
- **Symptom:** Framer Motion animation components exist (DrawAnimation, DiscardAnimation, MeldAnimation, WinAnimation) but never play
- **Cause:** `useAnimationQueue` hook and animation components aren't wired into the game event flow
- **Fix:** Wire `useAnimationQueue` into `GameView` so incoming events (draw, discard, meld, win) queue animations. Respect "instant" animation speed setting

### 1c. Replay Viewer Shows Nothing
- **Backend:** Modify `game_manager.py` to serialize full `GameState` snapshot into each replay frame
- **Frontend:** ReplayViewer already expects `frame.state` — will work once backend provides it

## 2. Interaction Feedback

### 2a. Tile Hover Effect
- Scale up `scale(1.05)` + subtle shadow lift on hover
- Use CSS `hover:` on TileBase SVG wrapper
- Smooth `transition-transform duration-150` (already partially there)

### 2b. Tile Click Feedback
- `active:scale-95` press-down for 100ms
- Then selected state (`-translate-y-2` + blue glow) kicks in

### 2c. Action Button Feedback
- `active:scale-95` + `transition-transform` on all ActionPanel buttons
- Subtle entrance animation when action options appear (slide-up + fade-in)

### 2d. Turn Indicator
- Replace thin yellow ring with a more prominent glow/pulse effect
- Add "YOUR TURN" badge when it's the human player's active turn
- Animate the badge entrance

### 2e. Discard Confirmation UX
- When a tile is selected, show a hint label: "Click again to discard" (or "再按一次出牌")
- Position below the selected tile or as a floating tooltip

## 3. Visual Polish

### 3a. Tile Shadows
- Multi-layer drop shadow on tile SVGs for realistic depth
- Subtle inner highlight on tile face for 3D feel

### 3b. Table Background
- Replace flat `bg-table-green` with a radial gradient (lighter center, darker edges)
- Optional subtle noise/texture overlay for felt-like appearance

### 3c. Player Areas
- Semi-transparent card-like backgrounds behind each player area
- Better spacing between hand, melds, and flowers
- Clearer visual hierarchy

### 3d. Discard Pool
- Inset shadow or subtle border to visually separate from table
- Better grid spacing

### 3e. Typography Hierarchy
- Game header: larger, bolder
- Player wind labels: medium with distinct styling
- Action labels: prominent with clear CTA styling

### 3f. Lobby Polish
- Decorative background pattern or subtle tile motif
- Improved button spacing, hover states, and visual hierarchy
- Connection status indicator more prominent

## 4. Technical Approach

- **Frontend design skill** will be used for all UI component changes
- All styling via Tailwind CSS classes (no inline styles)
- Animations via Framer Motion where appropriate, CSS transitions for micro-interactions
- Changes scoped to existing component files — no new component creation unless necessary
- Backend change limited to replay frame serialization

## 5. Success Criteria

- All tile interactions have visible hover/click feedback
- Discarding a tile does not flash the scoring screen
- Animations play for draw, discard, meld, and win events
- Replay viewer displays full game state at each frame
- Table, tiles, and UI elements look more polished and premium
- Turn indicator is immediately obvious
- Double-click-to-discard mechanic is discoverable via UI hint
