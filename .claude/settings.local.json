{
  "permissions": {
    "allow": [
      "Bash(cd:*)",
      "Bash(cmd.exe:*)",
      "Bash(powershell.exe:*)",
      "Bash(python --version 2>/dev/null || python3 --version 2>/dev/null; pip --version 2>/dev/null || pip3 --version 2>/dev/null)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && .venv/Scripts/python.exe -m pytest --collect-only 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run pytest tests/test_tiles.py -v 2>&1)",
      "Bash(head:*)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run pytest tests/test_shanten.py -v 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run pytest -v 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run pytest tests/test_rule_based.py -v 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run pytest tests/test_integration.py -v -s 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run python -c \"\nimport random, time\nfrom engine.game_session import GameSession, Action\nfrom ai.rule_based import RuleBasedAI\n\nAI = RuleBasedAI\\(\\)\nrandom.seed\\(0\\)\nsession = GameSession\\(\\)\nsession.start_hand\\(\\)\nmoves = 0\nstart = time.time\\(\\)\nwhile session.state.phase == 'play' and moves < 1000:\n    acted = False\n    for p in range\\(4\\):\n        legal = session.get_legal_actions\\(p\\)\n        if legal:\n            action = AI.choose_action\\(session.state, p, legal\\)\n            if action.player_idx is None:\n                action.player_idx = p\n            session.step\\(action\\)\n            acted = True\n            moves += 1\n            break\n    if not acted:\n        break\nelapsed = time.time\\(\\) - start\nprint\\(f'Seed 0: phase={session.state.phase}, moves={moves}, time={elapsed:.2f}s'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run python -c \"\nimport random\nfrom engine.game_session import GameSession, Action\nfrom ai.rule_based import RuleBasedAI\n\nAI = RuleBasedAI\\(\\)\nrandom.seed\\(0\\)\nsession = GameSession\\(\\)\nsession.start_hand\\(\\)\nmoves = 0\nlast_actions = []\nwhile session.state.phase == 'play' and moves < 50:\n    acted = False\n    for p in range\\(4\\):\n        legal = session.get_legal_actions\\(p\\)\n        if legal:\n            action = AI.choose_action\\(session.state, p, legal\\)\n            if action.player_idx is None:\n                action.player_idx = p\n            last_actions.append\\(\\(moves, p, action.type, action.tile, len\\(session.state.wall\\)\\)\\)\n            session.step\\(action\\)\n            acted = True\n            moves += 1\n            break\n    if not acted:\n        print\\('No player had legal actions!'\\)\n        break\n\nfor m, p, t, tile, wlen in last_actions:\n    print\\(f'Move {m}: player={p} type={t} tile={tile} wall_len={wlen}'\\)\nprint\\(f'Final phase: {session.state.phase}, wall: {len\\(session.state.wall\\)}'\\)\n\" 2>&1)",
      "Bash(cd \"C:/Users/wangd/文件/Mahjong/backend\" && uv run python -c \"\nimport random, time\nfrom tests.test_integration import run_one_hand\n\nstart = time.time\\(\\)\nfor seed in range\\(10\\):\n    result = run_one_hand\\(seed\\)\n    print\\(f'Seed {seed}: {result}'\\)\nprint\\(f'Time: {time.time\\(\\) - start:.2f}s'\\)\n\" 2>&1)",
      "Bash(cd /c/Users/wangd/文件/Mahjong/backend && python -m uv run python -c \"\nimport time, random\nfrom engine.game_session import GameSession, Action\nfrom ai.rule_based import RuleBasedAI\nfrom ai.shanten import shanten_number\n\nAI = RuleBasedAI\\(\\)\n\n# Time a single shanten call on a 16-tile hand\nhand = ['1m','3m','5m','7m','9m','1p','3p','5p','7p','9p','E','S','W','N','C','F']\nt0 = time.time\\(\\)\ns = shanten_number\\(hand, []\\)\nt1 = time.time\\(\\)\nprint\\(f'Shanten\\({len\\(hand\\)} tiles\\) = {s}, took {t1-t0:.3f}s'\\)\n\n# Time a connected hand\nhand2 = ['1m','2m','3m','4m','5m','6m','7m','8m','9m','1p','2p','3p','4p','5p','6p','1s']\nt0 = time.time\\(\\)\ns2 = shanten_number\\(hand2, []\\)\nt1 = time.time\\(\\)\nprint\\(f'Shanten\\({len\\(hand2\\)} tiles, connected\\) = {s2}, took {t1-t0:.3f}s'\\)\n\n# Time one full game\nrandom.seed\\(42\\)\nsession = GameSession\\(\\)\nsession.start_hand\\(\\)\nt0 = time.time\\(\\)\nmoves = 0\nwhile session.state.phase == 'play' and moves < 200:\n    acted = False\n    for p in range\\(4\\):\n        legal = session.get_legal_actions\\(p\\)\n        if legal:\n            action = AI.choose_action\\(session.state, p, legal\\)\n            if action.player_idx is None:\n                action.player_idx = p\n            session.step\\(action\\)\n            acted = True\n            moves += 1\n            break\n    if not acted:\n        break\nt1 = time.time\\(\\)\nprint\\(f'1 game: {moves} moves, {t1-t0:.3f}s, phase={session.state.phase}'\\)\n\" 2>&1)",
      "Bash(cd /c/Users/wangd/文件/Mahjong/backend && python -m uv run python -c \"\nimport time, random\nfrom engine.game_session import GameSession, Action\nfrom ai.rule_based import RuleBasedAI\n\nAI = RuleBasedAI\\(\\)\n\n# Time 10 games\nt0 = time.time\\(\\)\nfor seed in range\\(10\\):\n    random.seed\\(seed\\)\n    session = GameSession\\(\\)\n    session.start_hand\\(\\)\n    moves = 0\n    while session.state.phase == 'play' and moves < 1000:\n        acted = False\n        for p in range\\(4\\):\n            legal = session.get_legal_actions\\(p\\)\n            if legal:\n                action = AI.choose_action\\(session.state, p, legal\\)\n                if action.player_idx is None:\n                    action.player_idx = p\n                session.step\\(action\\)\n                acted = True\n                moves += 1\n                break\n        if not acted:\n            break\nt1 = time.time\\(\\)\nprint\\(f'10 games: {t1-t0:.2f}s \\({\\(t1-t0\\)/10:.2f}s/game\\)'\\)\nprint\\(f'Estimated 1000 games: {\\(t1-t0\\)*100:.0f}s'\\)\n\" 2>&1)",
      "Bash(wc:*)"
    ]
  }
}
